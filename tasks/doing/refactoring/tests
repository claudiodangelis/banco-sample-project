tests should be refactored as well